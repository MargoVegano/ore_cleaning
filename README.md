Подготовить прототип модели машинного обучения для компании, разрабатывающей решения для эффективной работы промышленных предприятий.
Модель должна предсказать коэффициент восстановления золота из золотосодержащей руды. В распоряжении данные с параметрами добычи и очистки.
Модель должна помочь оптимизировать производство, чтобы не запускать предприятие с убыточными характеристиками.

## Технологический процесс
Как золото получают из руды? 
Когда добытая руда проходит первичную обработку, получается дроблёная смесь. Её отправляют на флотацию (обогащение) и двухэтапную очистку.
![viruchka_1576238830](https://github.com/MargoVegano/ore_cleaning/assets/133104765/780ac30e-8906-423b-af77-2ae3829e90bb)

Опишем каждую стадию: 
1. Флотация
Во флотационную установку подаётся смесь золотосодержащей руды. После обогащения получается черновой концентрат и «отвальные хвосты», то есть остатки продукта с низкой концентрацией ценных металлов.
На стабильность этого процесса влияет непостоянное и неоптимальное физико-химическое состояние флотационной пульпы (смеси твёрдых частиц и жидкости).
2. Очистка 
Черновой концентрат проходит две очистки. На выходе получается финальный концентрат и новые отвальные хвосты.
## Описание данных
### Технологический процесс

- Rougher feed — исходное сырье
- Rougher additions (или reagent additions) — флотационные реагенты: Xanthate, Sulphate, Depressant
- Xanthate — ксантогенат (промотер, или активатор флотации);
- Sulphate — сульфат (на данном производстве сульфид натрия);
- Depressant — депрессант (силикат натрия).
- Rougher process (англ. «грубый процесс») — флотация
- Rougher tails — отвальные хвосты
- Float banks — флотационная установка
- Cleaner process — очистка
- Rougher Au — черновой концентрат золота
- Final Au — финальный концентрат золота

### Параметры этапов

- air amount — объём воздуха
- fluid levels — уровень жидкости
- feed size — размер гранул сырья
- feed rate — скорость подачи
 
### Наименование признаков
Наименование признаков должно быть такое:

[этап].[тип_параметра].[название_параметра]
Пример: rougher.input.feed_ag

### Возможные значения для блока [этап]:

- rougher — флотация
- primary_cleaner — первичная очистка
- secondary_cleaner — вторичная очистка
- final — финальные характеристики
- 
### Возможные значения для блока [тип_параметра]:

- input — параметры сырья
- output — параметры продукта
- state — параметры, характеризующие текущее состояние этапа
- calculation — расчётные характеристики

## Расчёт эффективности
Нужно смоделировать процесс восстановления золота из золотосодержащей руды.
Эффективность обогащения рассчитывается по формуле

![Recovery_1576238822](https://github.com/MargoVegano/ore_cleaning/assets/133104765/bf1d082b-1147-4679-a3ed-6458e33d6490)
где:

- C — доля золота в концентрате после флотации/очистки;
- F — доля золота в сырье/концентрате до флотации/очистки;
- T — доля золота в отвальных хвостах после флотации/очистки.
- 
Для прогноза коэффициента нужно найти долю золота в концентратах и хвостах. Причём важен не только финальный продукт, но и черновой концентрат.

## Метрика качества
Для решения задачи введём новую метрику качества — sMAPE (англ. Symmetric Mean Absolute Percentage Error, «симметричное среднее абсолютное процентное отклонение»).
Она похожа на MAE, но выражается не в абсолютных величинах, а в относительных. Почему симметричная? Она одинаково учитывает масштаб и целевого признака, и предсказания.

Метрика sMAPE вычисляется так:
![smape_1576238825](https://github.com/MargoVegano/ore_cleaning/assets/133104765/82bd7581-8101-4626-b2d8-70b28ee72663)

Обозначения:
![y1_1576238832](https://github.com/MargoVegano/ore_cleaning/assets/133104765/7c8f6078-64c1-4007-b5cb-15f114d14de3)
Значение целевого признака для объекта с порядковым номером i в выборке, на которой измеряется качество.

![yi_1_1576238835](https://github.com/MargoVegano/ore_cleaning/assets/133104765/71e3f968-b89c-47e6-8694-89b8b407b390)
Значение предсказания для объекта с порядковым номером i, например, в тестовой выборке.

![N_1_1576238819](https://github.com/MargoVegano/ore_cleaning/assets/133104765/49c53132-52c8-4384-ab9a-69f4f816830c)
Количество объектов в выборке.

![I_1576238817](https://github.com/MargoVegano/ore_cleaning/assets/133104765/236ce351-4ed5-4f6b-a04c-87f3c0627e9a)
Суммирование по всем объектам выборки (i меняется от 1 до N).

Нужно спрогнозировать сразу две величины:
эффективность обогащения чернового концентрата rougher.output.recovery;
эффективность обогащения финального концентрата final.output.recovery.

Итоговая метрика складывается из двух величин:
![_smape_1576238814](https://github.com/MargoVegano/ore_cleaning/assets/133104765/88e8bdb2-2bd7-4fc3-a738-d115ad947f72)

